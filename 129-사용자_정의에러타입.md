## 사용자 정의 에러 타입
Rust에서의 에러 처리 방식은 정적 타입 안전성과 명시적 흐름 제어를 중시하는 철학을 반영.
여기서는 두 가지 핵심 개념을 다룹니다:
- 사용자 정의 에러 타입: 내가 직접 만든 에러 구조체나 열거형
- ? 연산자: 에러 발생 시 자동으로 반환하게 해주는 간편한 문법


## 🧩 1. 사용자 정의 에러 타입이란?
Rust에서는 Result<T, E> 타입을 통해 에러를 표현합니다.
여기서 E는 에러 타입인데, 직접 정의한 열거형이나 구조체를 사용할 수 있어요.
### ✅ 기본 예시
```rust
use std::fmt;

#[derive(Debug)]
pub enum MyError {
    NotFound,
    InvalidInput(String),
}

impl fmt::Display for MyError {
    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {
        match self {
            MyError::NotFound => write!(f, "Item not found"),
            MyError::InvalidInput(msg) => write!(f, "Invalid input: {}", msg),
        }
    }
}

impl std::error::Error for MyError {}
```

### 💡 이 코드는 Display와 Error 트레이트를 구현해서
println!("{}", err)처럼 출력하거나 ? 연산자와 함께 사용할 수 있게 해줍니다.

## 🛠️ 2. thiserror 크레이트로 간편하게 정의하기
직접 구현하면 코드가 길어지기 때문에, 실무에서는  크레이트를 많이 사용합니다.

### ✅ 간단한 예시
```rust
use thiserror::Error;

#[derive(Debug, Error)]
pub enum FileError {
    #[error("파일을 찾을 수 없습니다: {0}")]
    NotFound(String),

    #[error("권한이 없습니다")]
    PermissionDenied,

    #[error("알 수 없는 IO 오류")]
    Io(#[from] std::io::Error),
}
```

- #[error("...")]로 메시지를 지정
- #[from]을 붙이면 ? 연산자가 자동으로 변환해줌

## ❓ 3. ? 연산자란?
?는 Result나 Option 타입에서 에러가 발생하면 자동으로 반환해주는 연산자입니다.
### ✅ 예시
```rust
use std::fs::File;
use std::io::{self, Read};

fn read_file(path: &str) -> Result<String, io::Error> {
    let mut file = File::open(path)?; // 에러 발생 시 자동 return
    let mut contents = String::new();
    file.read_to_string(&mut contents)?;
    Ok(contents)
}
```

### 💡 ?는 내부적으로 From 트레이트를 사용해서
io::Error → FileError처럼 타입을 자동 변환할 수 있어요.

### 🔗 사용자 정의 에러 + ? 연산자 조합 예시
```rust
use std::fs::File;
use std::io::{self, Read};
use thiserror::Error;

#[derive(Debug, Error)]
pub enum MyAppError {
    #[error("파일 오류: {0}")]
    FileError(#[from] io::Error),

    #[error("데이터 파싱 실패")]
    ParseError,
}

fn load_data(path: &str) -> Result<String, MyAppError> {
    let mut file = File::open(path)?; // io::Error → MyAppError::FileError
    let mut contents = String::new();
    file.read_to_string(&mut contents)?;
    Ok(contents)
}
```

- ? 연산자가 io::Error를 자동으로 MyAppError로 변환
- #[from] 덕분에 match 없이 간결한 코드 작성 가능

## 📌 요약 표
| 개념               | 설명                                                                 |
|--------------------|----------------------------------------------------------------------|
| 사용자 정의 에러    | 직접 만든 열거형 또는 구조체로 에러 상황을 표현                         |
| `Display` 트레이트 | 에러 메시지를 사람이 읽을 수 있게 출력                                 |
| `?` 연산자         | 에러 발생 시 자동으로 현재 함수에서 `Err` 반환                          |
| `#[from]` 속성     | 다른 에러 타입을 자동 변환해주는 thiserror의 기능                       |

---



