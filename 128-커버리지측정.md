# 커버리지 측정

Rust에서는 단순히 테스트를 통과하는 것뿐만 아니라, 얼마나 많은 코드가 실제로 테스트되었는지를 확인하는 것이 중요합니다.
이걸 테스트 커버리지 측정이라고 하고, 대표적인 도구로 cargo-tarpaulin과 grcov가 있어요.

## 📘 문서 테스트란?
Rust에서는 /// 주석 안에 예제 코드를 작성하면
cargo test 또는 cargo test --doc 명령어로 문서 속 코드가 실제로 컴파일되고 실행됩니다.
```
/// Adds two numbers.
/// ```
/// let result = add(2, 3);
/// assert_eq!(result, 5);
/// ```
```

- ✅ 문서 테스트는 예제가 실제로 동작하는지 검증해줍니다.
- 📚 문서와 테스트를 동시에 관리할 수 있어 신뢰도 높은 API 문서를 만들 수 있어요.

## 🧪 테스트 커버리지란?
테스트 커버리지는 전체 코드 중 테스트로 실행된 부분의 비율을 의미합니다.
예를 들어 함수가 10개 있는데, 테스트가 3개만 실행했다면 커버리지는 30%입니다.

## 🛠️ Rust 커버리지 도구
### ✅ 1. cargo-tarpaulin
- Rust 전용 커버리지 측정 도구
- 설치:
```
cargo install cargo-tarpaulin
```
- 실행:
```
cargo tarpaulin
```
- 특징:
- Linux에서 가장 안정적으로 작동
- #[test] 기반 유닛 테스트 커버리지 측정
- HTML 보고서도 생성 가능
- 제약:
- macOS에서는 Docker를 통해 실행해야 함

### ✅ 2. grcov
- Mozilla에서 만든 고급 커버리지 도구
- 설치:
```
cargo install grcov
```
- 사용 방식:
- Rust nightly 필요
- RUSTFLAGS와 CARGO_INCREMENTAL 설정 필요
- cargo test 실행 후 .gcda 파일을 분석해 HTML 보고서 생성
- 특징:
- 문서 테스트 포함 가능
- lcov, genhtml과 연동해 시각적 보고서 생성
- Firefox 개발에도 사용되는 고급 도구

## 📊 커버리지 보고서 예시
- HTML 형태로 생성되어 브라우저에서 확인 가능
- 각 함수별로 테스트된 줄과 테스트되지 않은 줄이 색상으로 표시됨
- 예: target/cov/index.html 또는 report/index.html

## 📌 요약 표
| 도구              | 설명                                      | 특징                          |
|-------------------|-------------------------------------------|-------------------------------|
| `cargo-tarpaulin` | Rust 전용 커버리지 측정 도구              | 설치 간편, Linux에 최적화     |
| `grcov`           | Mozilla 개발, 고급 커버리지 분석 도구     | 문서 테스트 포함, HTML 보고서 |
| `cargo test --doc`| 문서 속 예제 코드 테스트                  | 문서 신뢰도 향상               |

---



